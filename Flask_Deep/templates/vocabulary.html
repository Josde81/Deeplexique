{% extends "base.html" %}
{% block content %}
    <h1>Vocabulaire Deeplexique</h1>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <div id="app_deeplexique">
        <textarea v-model="text" cols="60" rows="15"></textarea>
        <button @click="cherche_vocabulaire">Chercher vocabulaire</button>
        {{erreur}}
        <ul>
            <li v-for="mot in vocabulaire">
                <div class="mot"> [[mot[0]]] </div>
                <span class="synonymes"> [[mot[1]]]</span>
            </li>
        </ul>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script>
        new Vue({
            el: '#app_deeplexique',
            data: {
                text: "C'était une de ces jolies et charmantes filles, nées, comme par une erreur du destin, dans une famille d'employés",
                vocabulaire: {},
                erreur :""
            },
            methods: {
                cherche_vocabulaire() {
                    var http = new XMLHttpRequest()
                    http.open("GET", "/syno/");
                    http.setRequestHeader("content-type", "application/json");
                    http.onload = () => {
                        this.vocabulaire = Object.entries(JSON.parse(http.responseText));
                        this.erreur = this.vocabulaire.length == 0? "text vide ou sans mot détecté":"";
                    }
                    http.send(JSON.stringify(this.text));
                }
            }
        })
    </script>
    
{% endblock content %}